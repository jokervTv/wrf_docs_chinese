<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>WRFDA 算法的改进 | WRF 中文文档</title>
    <meta name="description" content="WRF 技术手册 第4版 中英对照文档">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-alpha/dist/katex.min.css">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/wrf_docs_chinese/assets/css/0.styles.8a4a8319.css" as="style"><link rel="preload" href="/wrf_docs_chinese/assets/js/app.ba201b04.js" as="script"><link rel="preload" href="/wrf_docs_chinese/assets/js/4.dbc94423.js" as="script"><link rel="preload" href="/wrf_docs_chinese/assets/js/1.9cdc4f96.js" as="script"><link rel="preload" href="/wrf_docs_chinese/assets/js/20.87b5890b.js" as="script"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/10.263d31b7.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/11.17e7f316.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/12.d7758958.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/13.cc600116.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/14.7fc543f5.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/15.dbcb778b.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/16.e03d6598.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/17.47483412.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/18.a5516e64.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/19.6e20cf16.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/21.23d28cf6.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/22.f3a4843e.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/23.39c0de04.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/24.5955feda.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/25.5b02f582.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/26.9644fea4.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/27.283a4295.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/28.f50f5401.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/5.fd213fad.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/6.36d6460e.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/7.34919e43.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/8.0da55fdf.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/9.0255b641.js"><link rel="prefetch" href="/wrf_docs_chinese/assets/js/vendors~flowchart.f60ac95a.js">
    <link rel="stylesheet" href="/wrf_docs_chinese/assets/css/0.styles.8a4a8319.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container" data-v-319dd33c><div data-v-319dd33c><div id="loader-wrapper" class="loading-wrapper" data-v-4b73742e data-v-319dd33c data-v-319dd33c><div class="loader-main" data-v-4b73742e><div data-v-4b73742e></div><div data-v-4b73742e></div><div data-v-4b73742e></div><div data-v-4b73742e></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-1e2a0cc0 data-v-319dd33c data-v-319dd33c><h3 class="title" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0>WRF 中文文档</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0><input type="password" value="" data-v-1e2a0cc0> <span data-v-1e2a0cc0>Konck! Knock!</span> <button data-v-1e2a0cc0>OK</button></label> <div class="footer" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0><span data-v-1e2a0cc0><i class="iconfont reco-theme" data-v-1e2a0cc0></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-1e2a0cc0>vuePress-theme-reco</a></span> <span data-v-1e2a0cc0><i class="iconfont reco-copyright" data-v-1e2a0cc0></i> <a data-v-1e2a0cc0><span data-v-1e2a0cc0>jokervTv</span>
            
          <span data-v-1e2a0cc0>2020 - </span>
          2020
        </a></span></div></div> <div class="hide" data-v-319dd33c><header class="navbar" data-v-319dd33c><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wrf_docs_chinese/" class="home-link router-link-active"><!----> <span class="site-name">WRF 中文文档</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/jokervTv" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="mailto:zhangyp6603@outlook.com" class="nav-link external"><i class="iconfont reco-mail"></i>
  Email
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jokervtv.top/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-bokeyuan"></i>
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/jokervTv/wrf_docs_chinese" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask" data-v-319dd33c></div> <aside class="sidebar" data-v-319dd33c><div class="personal-info-wrapper" data-v-6c8ffc9c><!----> <h3 class="name" data-v-6c8ffc9c>
    jokervTv
  </h3> <div class="num" data-v-6c8ffc9c><div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>14</h3> <h6 data-v-6c8ffc9c>文章</h6></div> <div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>2</h3> <h6 data-v-6c8ffc9c>标签</h6></div></div> <hr data-v-6c8ffc9c></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/jokervTv" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="mailto:zhangyp6603@outlook.com" class="nav-link external"><i class="iconfont reco-mail"></i>
  Email
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://jokervtv.top/blog/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-bokeyuan"></i>
  博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/jokervTv/wrf_docs_chinese" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>wrf_technote</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrf_docs_chinese/wrf_technote/" class="sidebar-link">自述</a></li><li><a href="/wrf_docs_chinese/wrf_technote/preface.html" class="sidebar-link">序言</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>简介</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrf_docs_chinese/wrf_technote/1 Introduction.html" class="sidebar-link">简介</a></li><li><a href="/wrf_docs_chinese/wrf_technote/1.1 Advanced Research WRF.html" class="sidebar-link">Advanced Research WRF (ARW)</a></li><li><a href="/wrf_docs_chinese/wrf_technote/1.2 Major Features of the ARW System Version 4.html" class="sidebar-link">ARW系统第4版的主要功能</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>控制方程组</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrf_docs_chinese/wrf_technote/2 Governing Equations.html" class="sidebar-link">控制方程组</a></li><li><a href="/wrf_docs_chinese/wrf_technote/2.1 Vertical Coordinate and Flux-Form Variables.html" class="sidebar-link">垂直坐标和通量形式变量</a></li><li><a href="/wrf_docs_chinese/wrf_technote/2.2 Flux-Form Euler Equation.html" class="sidebar-link">通量形式欧拉方程</a></li><li><a href="/wrf_docs_chinese/wrf_technote/2.3 Map Projections, Coriolis and Curvature Terms.html" class="sidebar-link">地图投影，科里奥利和曲率项</a></li><li><a href="/wrf_docs_chinese/wrf_technote/2.4 Perturbation Form of the Governing Equations.html" class="sidebar-link">控制方程的扰动形式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>时间离散化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrf_docs_chinese/wrf_technote/3.1 Temporal Discretization.html" class="sidebar-link">模型离散化</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>数据同化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrf_docs_chinese/wrf_technote/11 Datra Assimilation.html" class="sidebar-link">数据同化</a></li><li><a href="/wrf_docs_chinese/wrf_technote/11.1 Introduction.html" class="sidebar-link">简介</a></li><li><a href="/wrf_docs_chinese/wrf_technote/11.2 Improvements to the WRFDA Algorithm.html" class="active sidebar-link">WRFDA 算法的改进</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wrf_docs_chinese/wrf_technote/11.2 Improvements to the WRFDA Algorithm.html#_11-2-1-四维变分和预测对观测的敏感性" class="sidebar-link">11.2.1 四维变分和预测对观测的敏感性</a></li><li class="sidebar-sub-header"><a href="/wrf_docs_chinese/wrf_technote/11.2 Improvements to the WRFDA Algorithm.html#_11-2-2-混合变分-集成技术" class="sidebar-link">11.2.2 混合变分/集成技术</a></li><li class="sidebar-sub-header"><a href="/wrf_docs_chinese/wrf_technote/11.2 Improvements to the WRFDA Algorithm.html#_11-2-3-卫星辐射数据同化" class="sidebar-link">11.2.3 卫星辐射数据同化</a></li><li class="sidebar-sub-header"><a href="/wrf_docs_chinese/wrf_technote/11.2 Improvements to the WRFDA Algorithm.html#_11-2-5-控制变量的选择" class="sidebar-link">11.2.5 控制变量的选择</a></li><li class="sidebar-sub-header"><a href="/wrf_docs_chinese/wrf_technote/11.2 Improvements to the WRFDA Algorithm.html#_11-2-6-其他改进" class="sidebar-link">11.2.6 其他改进</a></li></ul></li><li><a href="/wrf_docs_chinese/wrf_technote/11.3 Background Error Covariances.html" class="sidebar-link">背景误差协方差</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-1e2a0cc0 data-v-319dd33c><h3 class="title" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0>WRFDA 算法的改进</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0><input type="password" value="" data-v-1e2a0cc0> <span data-v-1e2a0cc0>Konck! Knock!</span> <button data-v-1e2a0cc0>OK</button></label> <div class="footer" style="display:none;" data-v-1e2a0cc0 data-v-1e2a0cc0><span data-v-1e2a0cc0><i class="iconfont reco-theme" data-v-1e2a0cc0></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-1e2a0cc0>vuePress-theme-reco</a></span> <span data-v-1e2a0cc0><i class="iconfont reco-copyright" data-v-1e2a0cc0></i> <a data-v-1e2a0cc0><span data-v-1e2a0cc0>jokervTv</span>
            
          <span data-v-1e2a0cc0>2020 - </span>
          2020
        </a></span></div></div> <div data-v-319dd33c><main class="page"><div class="page-title" style="display:none;"><h1>WRFDA 算法的改进</h1> <hr> <div data-v-484a899e><i class="iconfont reco-account" data-v-484a899e><span data-v-484a899e>jokervTv</span></i> <i class="iconfont reco-date" data-v-484a899e><span data-v-484a899e>2020-03-24</span></i> <i class="iconfont reco-eye" data-v-484a899e><span id="/wrf_docs_chinese/wrf_technote/11.2%20Improvements%20to%20the%20WRFDA%20Algorithm.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-484a899e><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="iconfont reco-tag tags" data-v-484a899e><span class="tag-item" data-v-484a899e>
      translate
    </span><span class="tag-item" data-v-484a899e>
      WRF
    </span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><p></p><div class="table-of-contents"><ul><li><a href="#_11-2-1-四维变分和预测对观测的敏感性">11.2.1 四维变分和预测对观测的敏感性</a></li><li><a href="#_11-2-2-混合变分-集成技术">11.2.2 混合变分/集成技术</a></li><li><a href="#_11-2-3-卫星辐射数据同化">11.2.3 卫星辐射数据同化</a></li><li><a href="#_11-2-5-控制变量的选择">11.2.5 控制变量的选择</a></li><li><a href="#_11-2-6-其他改进">11.2.6 其他改进</a></li></ul></div><p></p> <p>相对于 MM5 3DVAR 技术说明（Barker 等人，2003）和 ARW 第 3 版技术说明（Skamarock 等人，2008）中所述，WRFDA（V4）的最新版本进行了许多改进，其中包括四维变分（4D-Var）和混合变分/集合（Hybrid-EnVar）数据同化技术，卫星辐射的直接同化，雷达数据同化的改进以及其他新功能中对控制变量的更多选择。
这些将在下面简要概述，更多详细信息可以在引用的参考文献中找到。</p> <h2 id="_11-2-1-四维变分和预测对观测的敏感性"><a href="#_11-2-1-四维变分和预测对观测的敏感性" class="header-anchor">#</a> 11.2.1 四维变分和预测对观测的敏感性</h2> <p>4D-Var 的初始功能是在 WRFDA 3.1 中引入的（Huang 等，2009），Zhang 等人对此进行了进一步的改进（2013，2014年）。
WRFDA 4D-Var 允许使用 LBC 控制变量和 Jc-DFI（以控制重力波）。
4D-Var 模式下的 WRFDA 分析涉及在同化时间范围最小化过程中 ARW 的切线线性模型（TLM）的前向集成和 ARW 伴随模型（ADJ）的向后集成。
在 4.0 版中，WRFPlus 代码（即 WRF 的 TLM/ADJ）已完全集成到 WRF 主代码存储库中，这将简化将来的代码维护和开发。
虽然完整的 ARW 动力学的 TLM/ADJ（位于 WRF 源代码的 <code>wrftladj</code> 目录下）在 WRFPlus 代码中可用，但只有少数 WRF 物理方案具有相应的 TLM/ADJ，包括大规模冷凝和改良的 Kessler (温雨（Wang 等人，2013b) 方案，简化的积云参数化方案，垂直扩散和重力波阻力。
WRFPlus V4 尚未实现 ARW V4 的两个新功能（混合垂直坐标和湿势温度）中的 TLM/ADJ，但预计将在将来的版本中提供。
值得注意的是，自 3.4 版本以来，降水数据可以用 4D-Var 进行同化（Ban 等人，2017）。</p> <p>WRFDA 还引入了计算对观测值的预测敏感性（FSO）的功能（Zhang 等人，2015）。
FSO 允许使用 ARW 和 WRFDA 的伴随计算出不同观测值的预测影响。
请注意，在使用 WRFDA 计算 FSO 时，需要使用 Lanczos 最小化算法而不是共轭梯度法。</p> <h2 id="_11-2-2-混合变分-集成技术"><a href="#_11-2-2-混合变分-集成技术" class="header-anchor">#</a> 11.2.2 混合变分/集成技术</h2> <p>WRFDA 的 4D-Var 通过使用线性预测模型提供隐含的流相关的预测误差协方差，以在较短的时间范围内演变出扰动。
但是，这是有代价的。维护线性预测模型及其伴随物既需要计算资源，也需要人力资源。</p> <p>混合变分/集合数据同化尝试将集合数据同化的优点（流依赖性和灵活性）与变分系统的优点（同时处理观测值，动态/物理约束，复杂的质量控制，通过外循环处理非线性等）结合起来 ）。
WRFDA 混合算法（Wang 等，2008a，b）采用了所谓的 α 控制变量公式，该公式首先在英国气象局实施。
WRFDA hybrid 可在3D（即 hybrid-3DEnVar）或 4D（即 hybrid-4DEnVar）模式下运行，并允许双分辨率配置（Schwartz 等人，2015），即高分辨率的确定性背景和分析，以及较低分辨率的集合输入。</p> <p>值得注意的是，Hybrid-EnVar 算法使用由输入集形成的流相关的背景误差协方差来生成单个确定性分析，可以通过不同的方式获得该分析。
最简单的方法是从“第三方集合预测系统（EPS）（例如 NCEP 的全球集合预报系统（GEFS））获得集合输入。
在这种情况下，由于不需要运行自己的集合预测，因此可大大降低计算成本。
可以说，更好的方法是通过选择模型和分辨率来进行自己的集合分析和预测。
WRFDA 软件包包括一个程序，该程序执行集合变换卡尔曼滤波器（ETKF）以产生集合分析，然后可以生成集合预测并将其用作 WRFDA 混合分析的输入。
进行集合分析的另一种可能性是运行 WRFDA 混合 EnVar 集合，并对每个成员分析进行观察。</p> <h2 id="_11-2-3-卫星辐射数据同化"><a href="#_11-2-3-卫星辐射数据同化" class="header-anchor">#</a> 11.2.3 卫星辐射数据同化</h2> <p>WRFDA 3.1 中引入了辐射数据同化功能（Liu 和 Barker，2006年）。
WRFDA 可以提取 NCEP GFS 模型中可操作的大多数 BUFR 格式辐射数据（HIRS，AMSU-A/B，MHS，AIRS，IASI，ATMS，SSMIS 和 SEVIRI）。
此外，还可以将 HDF 格式的 AMSR2 辐射数据（Yang 等，2016）和 NETCDF 格式的 GOES-Imager 辐射数据（Yang 等，2017）同化。
WRFDA 系统的独特之处在于它与两种最广泛使用的快速辐射转移模型（RTM）交互：TOVS 的辐射转移（RTTOV）和社区辐射转移模型（CRTM），分别由欧洲气象卫星开发组织（EUMETSAT）和美国卫星数据同化联合中心（JCSDA）分别开发和维护。
到 RTTOV 和 CRTM 的灵活接口确保 WRFDA 用户可以从任何一个 RTM 可以模拟的传感器中吸收辐射数据，前提是已实施了相应的数据接口和质量控制。</p> <p>卫星辐射测量和 RTMs 容易出现系统误差（即偏差），必须先进行校正才能吸收辐射。
偏差通常随平台，仪器，通道，扫描角度和大气条件而变化。
WRFDA 采用所谓的变分偏差校正（VarBC）算法进行自适应和在线辐射偏差校正，该方法将线性回归中的偏差校正系数更新为变分最小化的一部分（Dee，2004; Auligne et al。，2007）。
值得一提的是，WRFDA 中提供了离线 VarBC 功能，以生成偏差校正系数的统计数据，而无需运行实际的 WRFDA 分析，这在进行短期数据同化实验时非常有用（Liu  等人，2012）。</p> <p>对于晴空条件下的辐射同化，WRFDA 实施了两种先进的高光谱红外传感器云检测方法，如 AIRS 和 IASI（Xu 等人，2013年，2014年，2015年；Auligne，2014a，b），这可以实现同化在云层上方达到峰值的通道。
在 3.9 版中，随着对全天空数据的所谓“对称误差模型”的发展（Geer 和 Bauer，2011），引入了 AMSR2 辐射数据的全天空辐射同化功能（Yang 等，2016）。</p> <p>11.2.4 雷达数据同化</p> <p>WRFDA v3 提供了吸收多普勒雷达径向速度和反射率观测值的初始功能（Xiao 等人，2005，2007a，b，2008）。
为了分析由于吸收了雷达径向速度而产生的垂直速度，引入了 Richarson 平衡方程及其线性和伴随代码。
对于反射率吸收，将总含水量用作控制变量。
这要求在最小化过程中在水汽和水凝物增量之间进行分配。
包括一个暖雨参数化以帮助计算水汽现象，包括水汽凝结成云，雨水积聚云，将云自动转换成雨以及将雨水蒸发成水蒸气。
包括多普勒径向速度和反射率的观测算子。</p> <p>从 3.7 版开始，WRFDA 包括一个附加选项，可以以 3D-Var 或 4D-Var 模式吸收雷达反射率检索到的水汽剖面（Wang 等，2013a，b； Sun和Wang，2013）。
还实现了吸收零回波雷达反射率的初步功能。</p> <h2 id="_11-2-5-控制变量的选择"><a href="#_11-2-5-控制变量的选择" class="header-anchor">#</a> 11.2.5 控制变量的选择</h2> <p>WRFDA 使用平方根 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span> 预处理，使得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mi>U</mi><msup><mi>U</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">B = UU^T</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span>（更多信息，请参见11.3）。
背景误差协方差矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span> 从未在模型空间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mtext>，</mtext><mi>v</mi><mtext>，</mtext><mi>T</mi><mtext>，</mtext><mi>q</mi><mtext>，</mtext><msub><mi>p</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">u，v，T，q，p_s</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">u</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mord cjk_fallback">，</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mord cjk_fallback">，</span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中明确计算。
在控制变量空间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span> 中，WRFDA 的成本函数被迭代最小化，该变量通过控制变量转换 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span> 与模型空间相关，即</p> <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>U</mi><mi mathvariant="bold">v</mi><mo>=</mo><msub><mi>U</mi><mi>p</mi></msub><msub><mi>U</mi><mi>v</mi></msub><msub><mi>U</mi><mi>h</mi></msub><mi mathvariant="bold">v</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(11.2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">x' = U\mathbf{v} = U_p U_v U_h \mathbf{v} \tag{11.2}
</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.801892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span><span class="tag"><span class="strut" style="height:1.088em;vertical-align:-0.286108em;"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span><span class="mord">1</span><span class="mord">.</span><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span></p> <p>展开 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>=</mo><msub><mi>U</mi><mi>p</mi></msub><msub><mi>U</mi><mi>v</mi></msub><msub><mi>U</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">U=U_p U_v U_h</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示协方差建模的各个阶段：通过递归滤波器的水平相关 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">U_h</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，通过 EOF 分解的垂直协方差 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">U_v</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，以及通过统计回归的多元协方差 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">U_p</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>。</p> <p>选择 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span> 的分量，以使它们的误差互相关可忽略不计，从而使矩阵 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span> 可以进行块对角线化。
通过名称列表参数 “<code>cv_options</code>”，WRFDA 中可以选择三种控制变量：</p> <ul><li><code>cv_options</code>=5：流函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">\psi'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，不平衡速度势 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>χ</mi><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\chi'_u</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>，不平衡温度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">T'_u</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>，假相对湿度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><msup><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">rh'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，不平衡表面压力 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><msubsup><mi>s</mi><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">ps'_u</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord mathdefault">p</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>。此选项允许在质量场和风场之间进行统计互相关，并进行单变量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">rh</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">h</span></span></span></span> 分析（即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">rh</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">h</span></span></span></span> 与其他变量之间没有互相关）。</li> <li><code>cv_options</code>=6：（Chen et al。，2013）：流函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">\psi'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，不均衡的潜在潜力 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>χ</mi><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\chi'_u</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">χ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>，不均衡的温度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">T'_u</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>，不均衡的假相对湿度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><msup><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">rh'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，不均衡的表面压力 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><msubsup><mi>s</mi><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">ps'_u</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.998892em;vertical-align:-0.247em;"></span><span class="mord mathdefault">p</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>。除了质量场和风场平衡之外，此选项还允许水分和其他变量之间相互关联，这在热带地区可能更为重要。</li> <li><code>cv_options</code>=7：（Sun 等，2015）：纬向风 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">u'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，经向风 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">v'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，温度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">T'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，假相对湿度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><msup><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">rh'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，表面压力 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><msup><mi>s</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">ps'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>。这些变量之间没有互相关（因此是完全单变量分析）。</li></ul> <p>附加的 <code>cv_options</code>=3 与 <code>cv_options</code>=5 相似，不同之处在于它使用递归过滤器而不是 EOF 分解进行垂直协方差，并且相应的背景误差协方差统计信息（由 WRFDA 发布）并非基于 ARW 预测。
在调试代码以进行新开发时（例如，添加新的观察类型），此选项很有用，但不建议用于需要分析和预测性能的操作环境。
为了获得最佳性能，建议遵循第（11.3）节中描述的过程，为选定的 <code>cv_options</code>= 5、6 或 7 使用适当的 ARW 模型设置来获得背景误差协方差统计信息。</p> <p>除了五个设置由 <strong><code>cv_options</code></strong> 控制的控制变量外，WRFDA 还可以分析与水凝物（<em>qcloud</em>，<em>qrain</em>，<em>qice</em>，<em>qsnow</em> 和 <em>qgraupel</em>）和垂直速度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span> 有关的变量。
需要这些控制变量来吸收受云/降水影响的观测值（例如，雷达反射率，全天辐射）和雷达径向速度数据。
分别由 namelist 参数 <code>cloud_cv_options</code>（= 0、1、2 或 3）和 <code>use_cv_w</code>（=  true 或 false）控制对水汽变量和垂直速度的分析。</p> <h2 id="_11-2-6-其他改进"><a href="#_11-2-6-其他改进" class="header-anchor">#</a> 11.2.6 其他改进</h2> <p>下面简要介绍了其他几个改进。</p> <ul><li>a）在版本 3.8 中引入的“弱罚约束”（WPEC）选项（Li 等，2015）旨在在分析中强制实现准梯度平衡。它的设计旨在改善热带气旋内雷达数据的同化性，但可能对类似规模的其他天气现象很有用。它可以与 3D-Var 或 Hybrid-3DEnVar 一起使用（4D-Var 与该功能不兼容）。</li> <li>b）在版本 4.0 中，添加了散度约束（DIVC）项以对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">u</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span> 之间的相关性进行建模。DIVC 是通过在成本函数中添加一个约束水平散度的项来实现的（Tong 等人，2016）。</li> <li>c）在 4.0 版本中引入的大尺度分析约束（LSAC）选项（Vendrasco 等人，2016）确保对流规模分析不会扭曲大尺度平衡，并消除了可能的大尺度偏差在 ARW 背景场中。全局分析或预测（例如来自 GFS 或 FNL 的分析或预测）被视为虚假观察，并通过 WRFDA 进行了吸收。使用 WPS/REAL 准备 LSAC 的输入数据，与准备 ARW 输入数据相同。</li> <li>d）在 4.0 版中增加了使用 GPS 多余相位（GPSEPH）非局地算子来同化 GPS 无线电掩星（GPSRO）折射率数据的新选项（Chen 等，2009），并采用了（Zhang 等，2014b）中描述的并行化策略。</li> <li>e）从 3.5 版开始，除了最初吸收u和v分量外，WRFDA还可以根据风速和风向吸收风的观测值（Huang 等，2013； Gao 等，2015）。</li></ul></div> <footer class="page-edit" style="display:none;"><div class="edit-link"><a href="https://github.com/jokervTv/wrf_docs_chinese/edit/master/wrf_technote/11.2 Improvements to the WRFDA Algorithm.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">4/13/2020, 3:40:21 PM</span></div></footer> <!----></main> <!----> <div style="display:none;" data-v-319dd33c data-v-319dd33c><div class="comments-wrapper" data-v-319dd33c><div class="valine-wrapper"><div id="valine"></div></div></div></div></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-a81d141e data-v-a81d141e><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-a81d141e><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-a81d141e></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-a81d141e></path></svg></div><div class="reading-progress top" data-v-21b39eda><div class="progress" data-v-21b39eda></div></div></div></div>
    <script src="/wrf_docs_chinese/assets/js/app.ba201b04.js" defer></script><script src="/wrf_docs_chinese/assets/js/4.dbc94423.js" defer></script><script src="/wrf_docs_chinese/assets/js/1.9cdc4f96.js" defer></script><script src="/wrf_docs_chinese/assets/js/20.87b5890b.js" defer></script>
  </body>
</html>
